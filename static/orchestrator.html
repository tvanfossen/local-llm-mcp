<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Agent Orchestrator - MCP Integration</title>
    <link rel="stylesheet" href="/static/css/orchestrator.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Agent Orchestrator - MCP Protocol</h1>
            <p>Direct MCP JSON-RPC Integration with Local LLM Server <span class="secure-badge">üîê Secured</span></p>
        </div>

        <div class="auth-section">
            <div class="auth-status">
                <div class="status-indicator" id="authIndicator"></div>
                <div class="auth-details">
                    <span class="auth-status-text" id="authStatusText">Not Authenticated</span>
                    <span class="auth-session-info" id="authSessionInfo">MCP operations require authentication</span>
                </div>
            </div>
            <textarea class="key-input" id="privateKey" placeholder="Paste your RSA private key here..." rows="4"></textarea>
            <button class="btn auth-btn" id="authBtn" onclick="authenticate()">Authenticate</button>
        </div>

        <div class="main-grid">
            <div class="panel auth-protected" id="agentsPanel">
                <div class="panel-header">
                    <h3>üì¶ Agent Registry</h3>
                    <button class="btn" onclick="refreshAgents()">Refresh</button>
                </div>
                <div id="agentsList"></div>
            </div>

            <div class="panel auth-protected" id="toolsPanel">
                <div class="panel-header">
                    <h3>üéÆ MCP Tools</h3>
                    <span id="selectedAgentName">No agent selected</span>
                </div>

                <div class="form-group">
                    <label>MCP Tool:</label>
                    <select class="tool-selector" id="toolSelector" onchange="updateToolInputs()">
                        <option value="">Select a tool...</option>
                        <option value="create_agent">Create Agent</option>
                        <option value="list_agents">List Agents</option>
                        <option value="get_agent_info">Get Agent Info</option>
                        <option value="delete_agent">Delete Agent</option>
                        <option value="chat_with_agent">Chat with Agent</option>
                        <option value="get_agent_file">Get Agent File</option>
                        <option value="system_status">System Status</option>
                    </select>
                </div>

                <div id="toolInputs">
                    <!-- Dynamic tool inputs will be inserted here -->
                </div>

                <div class="controls">
                    <button class="btn" onclick="executeMCPTool()" disabled id="executeBtn">Execute Tool</button>
                </div>
            </div>

            <div class="panel auth-protected" id="actionsPanel">
                <div class="panel-header">
                    <h3>üöÄ Quick Actions</h3>
                    <span id="mcpStatus">MCP Ready</span>
                </div>

                <div class="controls">
                    <button class="btn" onclick="quickListAgents()">List All Agents</button>
                    <button class="btn" onclick="getSystemStatus()">System Status</button>
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label>Quick Agent Chat:</label>
                    <textarea class="text-area" id="quickMessage" placeholder="Message for selected agent..."></textarea>
                    <button class="btn" onclick="quickChatWithAgent()" disabled id="quickChatBtn" style="margin-top: 10px;">Send Message</button>
                </div>
            </div>
        </div>

        <div class="terminal" id="terminal">
            <div class="terminal-line info">MCP-based orchestrator ready. Authenticate to begin.</div>
        </div>
    </div>

    <div class="websocket-status">
        <div class="status-indicator" id="wsIndicator"></div>
        <span id="wsStatus">Disconnected</span>
    </div>

    <div class="mcp-indicator">
        <div class="status-indicator" id="mcpIndicator"></div>
        <span>MCP Protocol</span>
    </div>

    <div class="auth-indicator">
        <div class="status-indicator" id="authIndicator2"></div>
        <span id="authStatus2">Not Authenticated</span>
    </div>

    <!-- Load MCP client and UI handlers -->
    <script src="/static/js/mcp-auth-handlers.js"></script>
    <script src="/static/js/mcp-parsers.js"></script>
    <script src="/static/js/mcp-client.js"></script>
    <script src="/static/js/agent-helpers.js"></script>
    <script src="/static/js/agent-operations.js"></script>
    <script src="/static/js/ui-templates.js"></script>
    <script src="/static/js/ui-handlers.js"></script>
    <script src="/static/js/orchestrator-main.js"></script>
</body>
</html>
